# Vinted.nl 库存宝

一个针对 Vinted.nl 网站的自动化库存管理解决方案，通过比特浏览器API采集员工账户的商品库存信息。

## ✨ 功能特性

- 🔄 **自动化数据采集**：通过比特浏览器API自动访问 Vinted.nl 网站
- 👥 **多账户管理**：支持批量处理员工账户库存信息
- 📊 **智能分类**：自动识别有库存、无库存和访问异常的账户
- 🖥️ **现代化界面**：简洁美观的桌面应用程序，支持emoji装饰
- 📄 **详细报告**：生成格式化的 TXT 报告文件
- ⚡ **实时监控**：显示采集进度和状态日志
- 🌐 **多语言支持**：支持荷兰语、英语等多种语言界面
- 📋 **分页检测**：智能检测关注列表分页，确保采集完整

## 🔧 系统要求

- macOS 10.14+ 或 Windows 10/11 64位系统
- 比特浏览器 (BitBrowser)
- 网络连接

## 🚀 快速开始

### 准备工作
1. **安装比特浏览器**：确保比特浏览器已安装并运行
2. **启动API服务**：比特浏览器默认API地址为 `http://127.0.0.1:54345`
3. **创建浏览器窗口**：在比特浏览器中创建并打开浏览器窗口
4. **登录Vinted**：在浏览器窗口中登录 Vinted.nl 账户

### macOS 用户
1. 双击运行 `VintedInventoryManager.app`
2. 🔧 **Step 1**: 确认比特浏览器API地址（默认：http://127.0.0.1:54345）
3. 🔗 **Step 2**: 点击"🧪 测试连接"验证API连接
4. 🌐 **Step 3**: 选择要使用的浏览器窗口
5. 📋 **Step 4**: 输入管理员关注列表 URL
6. 🚀 **Step 5**: 点击"🔍 开始查询"按钮

### Windows 用户
1. 运行 `VintedInventoryManager.exe`
2. 按照上述相同步骤操作

## 🔍 工作原理

### 核心逻辑流程

1. **比特浏览器API连接**
   - 连接到比特浏览器API服务（默认：http://127.0.0.1:54345）
   - 获取可用的浏览器窗口列表
   - 用户选择要使用的浏览器窗口

2. **关注列表提取**
   - 通过比特浏览器API控制指定浏览器窗口
   - 访问管理员的关注列表页面
   - 智能分页检测：逐页提取所有被关注的员工用户信息
   - 支持多语言结束标志检测（"doesn't follow anyone yet"、"volgt nog niemand"等）
   - 自动停止翻页当检测到无更多用户

3. **库存检查**
   - 依次访问每个员工的个人商店页面
   - 智能商品检测：检测页面中的商品列表
   - 空状态识别：识别"没有商品在售"等状态信息
   - 商品信息提取：统计商品数量和提取真实商品标题

4. **结果分类**
   - **✅ 有库存**：检测到商品的员工账户
   - **❌ 无库存**：显示"没有商品在售"的员工账户
   - **⚠️ 访问异常**：无法正常访问或解析的员工账户

5. **报告生成**
   - 生成详细的 TXT 格式报告
   - 包含每个分类的用户列表和商品信息
   - 显示采集统计数据和时间戳

### 🏗️ 技术架构

```
vinted-inventory-manager/
├── src/                           # 源代码目录
│   ├── main.py                   # 主程序入口
│   ├── gui/                      # 图形界面模块
│   │   ├── main_window.py        # 主窗口界面（现代化UI）
│   │   └── components.py         # UI组件
│   ├── core/                     # 核心功能模块
│   │   ├── vinted_scraper.py     # Vinted数据采集引擎
│   │   ├── bitbrowser_api.py     # 比特浏览器API管理器
│   │   └── data_processor.py     # 数据处理器
│   ├── utils/                    # 工具函数
│   │   ├── helpers.py            # 通用辅助函数
│   │   ├── config.py             # 配置管理
│   │   └── logger.py             # 日志管理
│   └── tests/                    # 测试文件
├── dist/                         # 构建输出目录
│   ├── VintedInventoryManager.app # macOS应用程序包
│   └── VintedInventoryManager.exe # Windows可执行文件
├── resources/                    # 资源文件
├── build.py                      # 构建脚本
├── version_manager.py            # 版本管理工具
├── requirements.txt              # Python依赖
├── CHANGELOG.md                  # 更新日志
└── README.md                     # 项目说明
```

## 🛠️ 开发环境设置

### 环境要求
- Python 3.8+
- 比特浏览器 (BitBrowser)
- Selenium WebDriver

### 安装步骤

```bash
# 克隆项目
git clone <repository-url>
cd vinted-inventory-manager

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# macOS/Linux:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt
```

### 运行开发版本

```bash
# 运行主程序
python src/main.py

# 运行测试
python -m pytest src/tests/
```

### 构建应用程序

#### 本地构建
```bash
# macOS构建
python build.py

# Windows构建（需要在Windows系统上运行）
python build_windows.py
```

#### 跨平台自动构建
```bash
# 使用GitHub Actions自动构建两个平台版本
git tag v1.x.x
git push origin v1.x.x
```

**重要**:
- PyInstaller无法跨平台构建，需要在对应系统上分别构建
- 详细构建说明请查看 [BUILD_GUIDE.md](BUILD_GUIDE.md)
- 每次修改代码后都需要重新构建应用程序包

### 版本管理

```bash
# 补丁版本更新（Bug修复）
python version_manager.py patch "修复描述"

# 次版本更新（新功能）
python version_manager.py minor "功能描述"

# 主版本更新（重大变更）
python version_manager.py major "重大变更描述"
```

## 📖 使用说明

### 准备工作
1. **安装比特浏览器**：确保比特浏览器已安装并运行
2. **启动API服务**：比特浏览器会自动启动API服务（默认端口54345）
3. **创建浏览器窗口**：在比特浏览器中创建新的浏览器窗口
4. **登录Vinted**：在浏览器窗口中登录 Vinted.nl 账户
5. **准备关注列表URL**：获取管理员账户的关注列表页面URL

### 操作步骤
1. **启动应用程序**：双击运行可执行文件
2. **🔧 Step 1**: 确认比特浏览器API地址（通常无需修改）
3. **🔗 Step 2**: 点击"🧪 测试连接"验证API连接状态
4. **🌐 Step 3**: 从列表中选择要使用的浏览器窗口
5. **📋 Step 4**: 输入管理员关注列表的完整 URL
6. **🚀 Step 5**: 点击"🔍 开始查询"按钮
7. **📊 Step 6**: 等待采集完成，点击"📄 打开结果"查看报告

### 注意事项
- 采集过程中请勿关闭比特浏览器或目标浏览器窗口
- 网络连接需要稳定，避免采集中断
- 大量用户的采集可能需要较长时间（每个用户约2-3秒）
- 报告文件会保存在应用程序同目录下
- 可以点击"📋 显示日志"查看详细的采集过程

## 🔧 故障排除

### 常见问题

**Q: 程序提示"连接失败"或找不到比特浏览器**
A:
- 确保比特浏览器已启动并运行
- 检查API地址是否正确（默认：http://127.0.0.1:54345）
- 确认比特浏览器的API服务已启用

**Q: 程序提示找不到浏览器窗口**
A:
- 在比特浏览器中创建并打开至少一个浏览器窗口
- 确保浏览器窗口已登录 Vinted.nl 账户
- 点击"🔄 刷新列表"重新获取窗口列表

**Q: 采集过程中断或出错**
A:
- 检查网络连接，确保 Vinted.nl 网站可正常访问
- 确认目标浏览器窗口没有被关闭
- 查看日志区域了解具体错误信息

**Q: 无法检测到用户关注列表结束**
A:
- 程序会自动检测多语言结束标志
- 检查关注列表URL是否正确
- 确认管理员账户的关注列表是公开的

**Q: 生成的报告为空或数据不完整**
A:
- 检查关注列表是否为空
- 确认访问权限，某些用户可能设置了隐私保护
- 查看日志了解具体的采集过程

**Q: 商品信息显示不正确**
A:
- 程序会智能过滤价格、评级等信息，只显示商品名称
- 如果显示"1"等数字，可能是商品名称提取失败
- 这通常不影响库存状态的判断

## 📋 更新日志

详细的更新记录请查看 [CHANGELOG.md](CHANGELOG.md)

当前版本：**v1.3.2** - 修正README文档，更新为比特浏览器API的正确描述

## 📄 许可证

本项目仅供内部使用。
